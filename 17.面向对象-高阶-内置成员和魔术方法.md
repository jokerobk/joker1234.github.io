# 面向对象-高阶-内置成员和魔术方法

## 内置成员

```python
# 获取类/对象的所属成员 类/对象.__dict__
res = Demo.__dict__  # 获取当前类的所属成员
res = obj.__dict__   # 获取当前对象的所属成员

# 获取类的文档信息 类/对象.__doc__
res = Demo.__doc__
res = obj.__doc__

# 获取类名称组成的字符串
res = Demo.__name__

# 获取类所在的文件名称，如果是当前文件，显示为__main__
res = Demo.__module__

# __bases__ 获取当前类的父类列表
res = Demo.__base__ # 获取继承的第一个父类
res = Demo.__bases__ # 获取继承的所有的父类列表

# MRO列表  获取当前类的继承链
res = Demo.__mro__
```

## 方法的分类

```python
1. 对象方法
    特征：
        1. 在类中定义的方法，含有self参数
        2. 含有self的方法，只能使用对象进行调用
        3. 该方法会把调用的对象传递进来

2. 类方法
    特征：
        1。在类中定义的方法，使用装饰器 @classmethod 进行了装饰
        2。方法中有cls这个行参。不需要实例化对象，直接使用类进行调用
        3。会把调用这个方法的类传递进来

3. 绑定类方法
    特征：
        1。在类中定义的方法
        2。只能使用类进行调用
        3。不会传递对象或者类进来

4. 静态方法
    特征：
        1。在类中定义的方法，使用了 装饰器 @staticmethod 进行了装饰
        2。可以使用对象或者类进行调用
        3。不会传递对象或者类进来
```

## 常用函数

```python
# 检测类和对象相关
# issubclass(子类,父类) # 检测一个类是否为另一个类的子类
# res = issubclass(D,B)

# isinstance(对象,类) # 检测一个对象是否是该类或该类的子类的实例化结果
# res = isinstance(d,A)

# 操作类和对象成员相关
# hasattr(对象/类,'成员名称')  检测类/对象是否包含指定名称的成员
# res = hasattr(d,'name')

#getattr(对象/类,'成员名称') # 获取类/对象的成员的值
# res = getattr(d,'say')

# setattr(对象/类,'成员名称','成员的值') 设置类/对象的成员的属性值
res = setattr(d,'name','ooo')
# print(d.name)

#delattr(类/对象,'成员名称') 删除类/对象的成员属性 和 del 直接删除对象的成员是一样的结果
# delattr(D,'name')

# dir() #获取当前对象所以可以访问的成员的列表
res = dir(d)
```

## 魔术方法

> 魔术方法就是不需要手动调用就可以自动执行的方法

```python
1. __init__ 初始化方法  *****
    触发机制：当实例化对象之后就会立即触发的方法
    作用：   为当前创建的对象完成一些初始化的操作，比如：成员属性的赋值，方法的调用，打开或创建一些资源。。
    参数：   一个self，接受当前对象，其它参数根据需求进行定义即可
    返回值： 无
    注意事项：无

2. __new__ 构造方法    ****
    触发机制：实例化对象时自动触发（在__init__之前触发）
    作用：   管理控制对象创建的过程
    参数：   一个cls 接收当前类，其它参数根据初始化方法的参数进行决定
    返回值： 必须返回object.__new__(cls)进行对象的创建，如果没有返回值，则实例化对象的结果为None
    注意事项：
            __new__方法的参数和__init__方法的参数要保持一致，除了第一个参数
            必须返回object.__new__(cls)进行对象的创建，如果没有返回值，则实例化对象的结果为None
    应用场景：设计模式中的单例设计模式


3. __del__ 析构方法    *****
    触发机制：当该类对象被销毁时，自动触发
    作用： 关闭或释放对象创建时打开或创建的一些资源
    参数： 一个self，接受当前的对象
    返回值：无
    注意事项： 无

4. __call__          ***
    触发机制： 把对象当作函数直接调用时自动触发
    作用：    一般用于归纳类或对象的操作步骤，方便调用
    参数：   一个self接收当前对象，其它参数根据调用需求缺点
    返回值：  可有可无
 
5.__len__
    触发机制： 当使用len函数去检测当前对象的时候自动触发
    作用：    可以使用len函数检测当前对象中某个数据的信息
    参数：    一个self 接收当前对象
    返回值：  必须有，并且必须是一个整型
    注意事项：len要获取什么属性的值，就在返回值中返回哪个属性的长度即可

6.__str__
    触发机制： 当使用str或者print函数对对象进行操作时自动触发
    作用：   代码对象进行字符串的返回，可以自定义打印的信息
    参数：  一个self，接收当前对象
    返回值： 必须有，而去必须是字符串类型的值

7.__repr__
    触发机制：在使用repr方法对当前对象进行转换时自动触发
    作用： 可以设置repr函数操作对象的结果
    参数：  一个self，接收当前对象
    返回值： 必须有，而去必须是字符串类型的值
    注意：正常情况下，如果没有__str__这个魔术方法，__repr__方法就会代替__str__魔术方法

8.__bool__
    触发机制： 当前使用bool函数转换当前对象时，自动触发.默认情况下，对象会转为True
    作用：    可以代替对象进行bool类型的转换，可以转换任何数据
    参数 ：   一个self 接收对象
    返回值： 必须是一个布尔类型的返回值
```

## 成员相关魔术方法

```python
## 1. __getattribute__   优先级最高
    触发机制：当访问对象成员时，自动触发，无论当前成员是否存在
    作用：   可以在获取对象成员时，对数据进行一些处理
    参数：   一个self接收对象，一个item接收当前访问的成员名称
    返回值： 可有可无，返回的值就是访问的结果
    注意事项：在当前的魔术方法中，禁止对当前对象的成员进行访问，会触发递归。
            如果想要在当前魔术方法中访问对象的成员必须使用 object 来进行访问
            格式： object.__getattribute__(self,item)

## 2. __getattr__
    触发机制： 当访问对象中不存在的成员时，自动触发
    作用：  防止访问不存在的成员时报错，也可以为不存在的成员进行赋值操作
    参数：  一个self接收当前对象，一个item接收当前访问的成员名称
    返回值： 可有可无
    注意事项： 当存在 __getattribute__ 方法时，会去执行 __getattribute__ 方法
    					也要注意，不要在当前的方法中再次去访问这个不存在的成员，会触发递归操作

## 3. __setattr__
    触发机制： 当给对象的成员进行赋值操作时会自动触发（包括添加，修改）
    作用：   可以限制或管理对象成员的添加和修改操作
    参数： 1。self 接收当前对象  2。key 设置的成员名  3。val 设置的成员值
    返回值： 无
    注意事项：在当前的魔术方法中禁止给当前对象的成员直接进行赋值操作，会触发递归操作
            如果想要给当前对象的成员进行赋值，需要借助 object
            格式： object.__setattr__(self,key,value)
## 4. __delattr__
    触发机制： 当删除对象成员时自动触发
    作用： 可以去限制对象成员的删除，还可以删除不存在成员时防止报错
    参数：1，self 接收当前对象  2。item 删除的成员名称
    返回值： 无
    注意事项： 在当前魔术方法中禁止直接删除对象的成员，会触发递归操作。
            如果想要删除当前对象的成员，那么需要借助 object
            格式： object.__delattr__(self,item)
```

## 访问成员的顺序！！！

1. 调用 `__getattribute__ `魔术方法
2. 调用数据描述符【后面会讲】
3. 调用当前对象的成员
4. 调用当前类的成员
5. 调用非数据描述符【后面会讲】
6. 调用父类的成员
7. 调用`__getattr__`魔术方法

> 以上步骤时调用某个成员时的顺序，前面的能够调用成功，后面则不在执行